<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="ThemeBucket">
  <link rel="shortcut icon" href="#" type="image/png">

  <title>Profile</title>
  <link href="css/layer.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet">
    <!--file upload-->
    <link rel="stylesheet" type="text/css" href="css/bootstrap-fileupload.min.css" />
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="js/html5shiv.js"></script>
  <script src="js/respond.min.js"></script>
  <![endif]-->
</head>

<body class="sticky-header">

<section>
    <!-- left side start-->
    <div class="left-side sticky-left-side">

        <!--logo and iconic logo start-->
        <div class="logo">
            <a href="index.html"><img src="images/logo.png" alt=""></a>
        </div>

        <div class="logo-icon text-center">
            <a href="index.html"><img src="images/logo_icon.png" alt=""></a>
        </div>
        <!--logo and iconic logo end-->


        <div class="left-side-inner">

            <!-- visible to small devices only -->
            <div class="visible-xs hidden-sm hidden-md hidden-lg">
                <div class="media logged-user">
                    <img alt="" src="images/photos/user-avatar.png" class="media-object">
                    <div class="media-body">
                        <h4><a href="#">John Doe</a></h4>
                        <span>"Hello There..."</span>
                    </div>
                </div>

                <h5 class="left-nav-title">Account Information</h5>
                <ul class="nav nav-pills nav-stacked custom-nav">
                    <li><a href="#"><i class="fa fa-user"></i> <span>Profile</span></a></li>
                    <li><a href="#"><i class="fa fa-cog"></i> <span>Settings</span></a></li>
                    <li><a href="#"><i class="fa fa-sign-out"></i> <span>Sign Out</span></a></li>
                </ul>
            </div>

            <!--sidebar nav start-->
            <ul class="nav nav-pills nav-stacked custom-nav">
                <li id="main"><a href="dynamic_table.html"><i class="fa fa-home"></i> <span>主页</span></a></li>
                <li id="profile"><a href="profile.html"><i class="fa fa-laptop"></i> <span>个人中心</span></a></li>
               	<li id="login"><a href="login.html"><i class="fa fa-sign-in"></i> <span>登录</span></a></li>
               	<li id="teacher"><a href="student_list.html"><i class="fa fa-laptop"></i> <span>教师管理</span></a></li>

            </ul>
            <!--sidebar nav end-->

        </div>
    </div>
    <!-- left side end-->
    
    <!-- main content start-->
    <div class="main-content" id="app">

        <!-- header section start-->
        <div class="header-section">

        <!--toggle button start-->
        <a class="toggle-btn"><i class="fa fa-bars"></i></a>
        <!--toggle button end-->

        <!--search start-->
        <form class="searchform" action="index.html" method="post">
            <input type="text" class="form-control" name="keyword" placeholder="Search here..." />
        </form>
        <!--search end-->

        <!--notification menu start -->
        <div class="menu-right">
            <ul class="notification-menu">
                <li>
                    <a href="#" class="btn btn-default dropdown-toggle info-number" data-toggle="dropdown">
                        <i class="fa fa-tasks"></i>
                        <span class="badge">8</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-head pull-right">
                        <h5 class="title">You have 8 pending task</h5>
                        <ul class="dropdown-list user-list">
                            <li class="new">
                                <a href="#">
                                    <div class="task-info">
                                        <div>Database update</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div style="width: 40%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="40" role="progressbar" class="progress-bar progress-bar-warning">
                                            <span class="">40%</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="new">
                                <a href="#">
                                    <div class="task-info">
                                        <div>Dashboard done</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div style="width: 90%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="90" role="progressbar" class="progress-bar progress-bar-success">
                                            <span class="">90%</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div class="task-info">
                                        <div>Web Development</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div style="width: 66%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="66" role="progressbar" class="progress-bar progress-bar-info">
                                            <span class="">66% </span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div class="task-info">
                                        <div>Mobile App</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div style="width: 33%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="33" role="progressbar" class="progress-bar progress-bar-danger">
                                            <span class="">33% </span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <div class="task-info">
                                        <div>Issues fixed</div>
                                    </div>
                                    <div class="progress progress-striped">
                                        <div style="width: 80%" aria-valuemax="100" aria-valuemin="0" aria-valuenow="80" role="progressbar" class="progress-bar">
                                            <span class="">80% </span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="new"><a href="">See All Pending Task</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="#" class="btn btn-default dropdown-toggle info-number" data-toggle="dropdown">
                        <i class="fa fa-envelope-o"></i>
                        <span class="badge">5</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-head pull-right">
                        <h5 class="title">You have 5 Mails </h5>
                        <ul class="dropdown-list normal-list">
                            <li class="new">
                                <a href="">
                                    <span class="thumb"><img src="images/photos/user1.png" alt="" /></span>
                                        <span class="desc">
                                          <span class="name">John Doe <span class="badge badge-success">new</span></span>
                                          <span class="msg">Lorem ipsum dolor sit amet...</span>
                                        </span>
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    <span class="thumb"><img src="images/photos/user2.png" alt="" /></span>
                                        <span class="desc">
                                          <span class="name">Jonathan Smith</span>
                                          <span class="msg">Lorem ipsum dolor sit amet...</span>
                                        </span>
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    <span class="thumb"><img src="images/photos/user3.png" alt="" /></span>
                                        <span class="desc">
                                          <span class="name">Jane Doe</span>
                                          <span class="msg">Lorem ipsum dolor sit amet...</span>
                                        </span>
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    <span class="thumb"><img src="images/photos/user4.png" alt="" /></span>
                                        <span class="desc">
                                          <span class="name">Mark Henry</span>
                                          <span class="msg">Lorem ipsum dolor sit amet...</span>
                                        </span>
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    <span class="thumb"><img src="images/photos/user5.png" alt="" /></span>
                                        <span class="desc">
                                          <span class="name">Jim Doe</span>
                                          <span class="msg">Lorem ipsum dolor sit amet...</span>
                                        </span>
                                </a>
                            </li>
                            <li class="new"><a href="">Read All Mails</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <a href="#" class="btn btn-default dropdown-toggle info-number" data-toggle="dropdown">
                        <i class="fa fa-bell-o"></i>
                        <span class="badge">4</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-head pull-right">
                        <h5 class="title">Notifications</h5>
                        <ul class="dropdown-list normal-list">
                            <li class="new">
                                <a href="">
                                    <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                                    <span class="name">Server #1 overloaded.  </span>
                                    <em class="small">34 mins</em>
                                </a>
                            </li>
                            <li class="new">
                                <a href="">
                                    <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                                    <span class="name">Server #3 overloaded.  </span>
                                    <em class="small">1 hrs</em>
                                </a>
                            </li>
                            <li class="new">
                                <a href="">
                                    <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                                    <span class="name">Server #5 overloaded.  </span>
                                    <em class="small">4 hrs</em>
                                </a>
                            </li>
                            <li class="new">
                                <a href="">
                                    <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                                    <span class="name">Server #31 overloaded.  </span>
                                    <em class="small">4 hrs</em>
                                </a>
                            </li>
                            <li class="new"><a href="">See All Notifications</a></li>
                        </ul>
                    </div>
                </li>
                <!-- <li>
                    <a href="#" class="btn btn-default dropdown-toggle" data-toggle="dropdown" v-if="seen">
                        <img :src="slogo" alt="" />
                        {{clname}}:{{sname}}
                        <span class="caret"></span>
                    </a>
                    <a href="login.html" id="loginNone" class="btn btn-default dropdown-toggle" v-else>
                        	登录/注册                   
                    </a>
                    <ul class="dropdown-menu dropdown-menu-usermenu pull-right">
                        <li><a href="#"><i class="fa fa-user"></i>  Profile</a></li>
                        <li><a href="#"><i class="fa fa-cog"></i>  Settings</a></li>
                        <li><a href="login.html" @click="logout()"><i class="fa fa-sign-out"></i> Log Out</a></li>
                    </ul>
                </li> -->
                <li>
                    <a href="login.html" id="loginOK" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                        <img id="stuImg" src="" alt="" />
                        <span id="sname2" title=""></span>  
                                   
                    </a>
                    <a href="login.html" id="loginNone" class="btn btn-default dropdown-toggle">
                        	登录/注册                   
                    </a>
                    <ul class="dropdown-menu dropdown-menu-usermenu pull-right">
                       <!--  <li><a href="#"><i class="fa fa-user"></i>  Profile</a></li>
                        <li><a href="#"><i class="fa fa-cog"></i>  Settings</a></li> -->
                        <li><a href="login.html" id="logout"><i class="fa fa-sign-out"></i> Log Out</a></li>
                    </ul>
                </li>
                

            </ul>
        </div>
        <!--notification menu end -->

        </div>
        <!-- header section end-->

        <!-- page heading start-->
        <!--<div class="page-heading">-->
            <!--Page Tittle goes here-->
        <!--</div>-->
        <!-- page heading end-->

        <!--body wrapper start-->
        <div class="wrapper">

            <div class="row">
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="profile-pic text-center" style="height: 220px;margin-top:10px;">
                                        <!-- <img alt="" :src="slogo"> -->
                                        
                                        <form class="form-signin" id="stuForms" method="post" enctype="multipart/form-data" style="margin-top:10px;">
                                        <input type="hidden" name="sidd" :value="sid">
                                        
                                        <div class="fileupload fileupload-new" data-provides="fileupload">
                                            
                                            <div class="fileupload-new thumbnail" style="width: 180px; height: 180px;border:none;">
                                                <img :src="slogo" alt="" />
                                            </div>
                                            
                                           
                                        </div> 
                                                                                                        
                                        </form>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="panel">
                                <div class="panel-body">
                                    <ul class="p-info">
                                        <li>
                                            <div class="title">学号</div>
                                            <div class="desk">{{sid}}</div>
                                        </li>
                                        <li>
                                            <div class="title">学生姓名</div>
                                            <div class="desk">{{sname}}</div>
                                        </li>
                                        <li>
                                            <div class="title">班级</div>
                                            <div class="desk">{{clname}}</div>
                                        </li>
                                        <li>
                                            <div class="title">入学日期</div>
                                            <div class="desk">{{sdate}}</div>
                                        </li>
                                        <li>
                                            <div class="title">性别</div>
                                            <div class="desk" v-if="ssex==1">男</div>
                                            <div class="desk" v-else>女</div>
                                        </li>
                                        <li>
                                            <div class="title">电话号码</div>
                                            <div class="desk">{{stel}}</div>
                                        </li>
                                        <li>
                                            <div class="title">email</div>
                                            <div class="desk">{{semail}}</div>
                                        </li>
                                        <li>
                                            <div class="title">现居地</div>
                                            <div class="desk">{{scity}}</div>
                                        </li>
                                       
                                        <button type="button" class="btn btn-danger" @click="Changeifo()">编辑资料</button>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        
                        
                        
                        
                        <!-- 模态框 data-backdrop="static"//点击模态框以外地方，模态框不关闭 -->
            			<div class="modal fade" id="exampleModal" data-backdrop="static" tabindex="-1" role="dialog" 
                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                             <button @click="getInit()" type="button" class="close" data-dismiss="modal" aria-label="Close"><span  aria-hidden="true">×</span>
 												</button>
			                					<h4 class="modal-title" id="exampleModalLabel">你仅可以编辑部分资料</h4>
                                        </div>
                                        <div class="modal-body">
                                           <form >               
                                                        
                                        		<div class="form-group">  
			                        				 学号：<span>{{sid}}</span>
			                                     </div>  
			                                     <div class="form-group">  
			                                   		学生姓名：<span>{{sname}}</span>
			                                     </div>			                   					
			                  					  <div class="form-group">  
			                      					 	班级：<span>{{clname}}</span>
			                  					  </div>
			                  					  <div class="form-group">  
			                      					 	入学日期：<span>{{sdate}}</span>
			                  					  </div>			                  					  
			                  					  <div class="form-group">  
			                      					 	性别：
			                      					 	<input type="radio" value="1" name="sex" v-model="ssex">男
           												<input type="radio" value="2"  name="sex"  v-model="ssex">女
         	                  					  </div>
			                  					  <div class="form-group">
			                      					 	电话号码：<input type="text" v-model="stel">
			                  					  </div>
			                  					   <div class="form-group">  
			                      					 	email：<input type="text" v-model="semail"/>
			                  					  </div>
			                  					   <div class="form-group">  
			                      					 	现居地：<input type="text" v-model="scity"/>
			                  					  </div>
			                  					  
											</form>
  									      </div>     
                                                  <div class="modal-footer">
                                        <button @click="sendModel()" type="button" style="width: 200px;" id="sendModel" class="btn btn-primary">Send message</button>
			                			<button @click="getInit()" type="button" style="width: 100px;" class="btn btn-default" data-dismiss="modal">Close</button>  

                                        </div>
                                    </div>
                                </div>
                            </div>
                        
                        
                        
                        
                        
                       
                         <div class="col-md-12">
                         <h4>他选择的公司及专业</h4>
                          
                            <div class="panel" >
                                <div class="panel-body p-states green-box">
                                
                                    <div class="summary pull-left">
                                    	
                                        <h3>{{cname}}</h3><br>
                                        <h4>{{pname}}</h4>
                                      
                                    </div>
                                    <div id="pro-refund" class="chart-bar"></div>
                                </div>
                            </div>
                           
                            <!-- <span v-else><button type='button' class='btn btn-danger' @click="gotodynamic()">去选择</button></span> -->
                        </div>
                        
                        <div class="col-md-12">
                        <h4>他的收藏</h4>
                            <div class="panel" v-for="like in listMap">
                            
                                <div class="panel-body p-states">
                                	
                                    <div class="summary pull-left">
                                    	
                                        <h4><img :src="like.clogo" width="60px" height="60px">
                                        {{like.cname}}
                                        </h4>
                                    </div>
                                   <!--  </a> -->
                                    <div id="expense" class="chart-bar"></div>
                                </div>
                            </div> 
                          
                        </div>
                       
                        
                    </div>
                </div>
                
             
                
                
                
                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="profile-desk">
                                        <h1>{{sname}}</h1>
                                        <span class="designation">{{signature}}</span>
                                        <p>
                                           {{sresume}}
                                        </p>
                                       
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel">
                                <header class="panel-heading">
                                    	记录每天的点点滴滴
                                    <span class="tools pull-right">
                                        <a class="fa fa-chevron-down" href="javascript:;"></a>
                                        <a class="fa fa-times" href="javascript:;"></a>
                                     </span>
                                </header>
                                <div class="panel-body">
                                    <ul class="activity-list">
                                        <li v-for="word in words">
                                            <div class="avatar">
                                                <img :src="slogo" alt=""/>
                                            </div>
                                            <div class="activity-desk">
                                                <h5>{{sname}}</h5>
                                                <p class="text-muted">发布于：{{word.spfdate}}</p>
                                                <span>{{word.spftest}}</span>
                                                <div class="album">
                                                        <img width="100px" height="100px" :src="'upload/'+word.spflogo" v-if="word.spflogo!=null&&word.spflogo!=''">
                                                </div>
                                            </div>
                                        </li>                                        
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!--body wrapper end-->

        <!--footer section start-->
        <footer class="">
            2014 &copy; AdminEx by <a href="http://www.mycodes.net/" target="_blank">源码之家</a>
        </footer>
        <!--footer section end-->


    </div>
    <!-- main content end-->
</section>

<!-- Placed js at the end of the document so the pages load faster -->
<script src="js/jquery-1.10.2.min.js"></script>
<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="js/jquery-migrate-1.2.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/modernizr.min.js"></script>
<script src="js/jquery.nicescroll.js"></script>
<script src="js/paragram.js"></script>
<!--Sparkline Chart-->
<script src="js/sparkline/jquery.sparkline.js"></script>
<script src="js/sparkline/sparkline-init.js"></script>

<!--google map-->
<!-- <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&AMP;sensor=false"></script> -->


<!--common scripts for all pages-->
<script src="js/scripts.js"></script>
<script type="text/javascript" src="js/vue.js"></script>
	<script type="text/javascript" src="js/vue-resource.min.js"></script>
	
	
<!--file upload-->
<script type="text/javascript" src="js/bootstrap-fileupload.min.js"></script>
	<script src="js/layer.js"></script>

<script type="text/javascript">
var app=new Vue({
	el:"#app",
	data:{
		stuInfo:'',
		slogo:'',
		sname:'',
		clname:'',
		sid:'',
		sdate:'',
		ssex:'',
		scity:'',
		stel:'',
		semail:'',
		pname:'',
		cname:'',
		signature:'',
		sresume:'',
		usernifo:'',
		listMap:[],
		words:[]
	}, 
	mounted(){
		this.getIndex();
		
	},
	methods:{
		getIndex:function(){
			this.getInit();
			
		},
		getInit(){
			//HTML5和大多数浏览器兼容性问题了。
			if(window.localStorage){
				//读取HTML5中的缓存，key是deptlist，而且读取出来text格式，还需要JSON.p.. text转换为json格式
				this.usernifo=JSON.parse(localStorage.getItem("teainfo"));
			}else{
				this.usernifo=Cookie.read("teainfo");
			}
			if(this.usernifo!=null && this.usernifo!=""){
				//alert(usernifo.sname);
			    $("#sname2").html(this.usernifo.teaname);
			    $("#sname2").attr("title",this.usernifo.teaid);
			    //alert(usernifo.slogo);
			    $("#stuImg").attr("src","upload/"+this.usernifo.tealogo);
			    $("#loginOK").css('display','block');
			    $("#loginNone").css('display','none');
			  	for(var i=0;i<this.usernifo.teamenus.length;i++){
			  		$("#"+this.usernifo.teamenus[i]+"").hide();
			  	}
			    //getScid();
			}else{
				$("#loginNone").css('display','block');
			    $("#loginOK").css('display','none');
			    //dataTable();
			}
			var Request=new Object();
			Request=GetRequest();
			this.sid=Request['sid'];
			this.$http.post('selectStuInfoBysid',{sid:this.sid},{emulateJSON:true})
			.then(function(res){
					this.stuInfo=res.body;					
					this.setStuInfo();
					this.getlikes();
					this.getWord();
					},function(res){
						alert("error")
					});
			
		},
		setStuInfo(){
			
			this.slogo="upload/"+this.stuInfo.slogo;
			this.signature=this.stuInfo.signature;
			this.sresume=this.stuInfo.sresume;
			this.clname=this.stuInfo.classes.clname;
			this.sname=this.stuInfo.sname;
			this.sdate=this.stuInfo.sdate;
			this.ssex=this.stuInfo.ssex;
			this.scity=this.stuInfo.scity;
			this.stel=this.stuInfo.stel;
			this.semail=this.stuInfo.semail;
			this.cname=this.stuInfo.cname;
			this.pname=this.stuInfo.pname;
		},
		getlikes(){
			this.$http.post('selectLikeAll',{cid:1,sid:this.sid},{emulateJSON:true})
			.then(function(res){
					this.listMap=res.body.listMap;
					},function(res){
						alert("error")
					});
		},
		Changeifo(){
			if(this.usernifo==null||this.usernifo==""){
				if(confirm("请先登录，再填写资料")){
					location.href="login.html";
				}
				return;
			}												
			 $("#exampleModal").modal("show");
			
		},
		sendModel(){	
			if(this.stel.length>11){
				alert("手机号不合法!");
				this.stel=this.stuInfo.stel;
				$("#exampleModal").modal("hide");
				return;
			}
			this.$http.post('updateStuInfo',{ssex:this.ssex,sid:this.sid,stel:this.stel,semail:this.semail,scity:this.scity},
					{emulateJSON:true}).then(function(res){
					if(res.body.indexOf("ok")!=-1){
						this.stuInfo.ssex=this.ssex;						
						this.stuInfo.stel=this.stel;
						this.stuInfo.semail=this.semail;
						this.stuInfo.scity=this.scity;
						
						layer.alert('修改资料成功', {
						    skin: 'layui-layer-lan'
						    ,closeBtn: 0
						    ,anim: 5 //动画类型
						  });	
						$("#exampleModal").modal("hide");
					}else{						
						alert(res.body);
					}							
					
					},function(res){
						alert("error")
					});
		},
		getWord(){
			this.$http.post('getProfileWord',{sid:this.sid},
					{emulateJSON:true}).then(function(res){
						this.words=res.body;
					},function(res){
						alert("error")
					});
		},
		cl(key,msg){
			//存储，IE6~7 cookie 其他浏览器HTML5本地存储
			//判断当前浏览器是否支持HTML5，
			if (window.localStorage) {
				 //封装浏览器缓存 WebStrong，setItem类似setAttribute方法
			    localStorage.setItem(key,msg);	
			} else {
				//封装Cookie
			    Cookie.write(key,msg);	
			}
		},
		/* gotoComDeail(){
			location.href="comp_details2.html?cid="+this.cid+"&pros="+this.pros;
		}, */
		logout(){
			if (window.localStorage) {
				window.localStorage.removeItem("stuinfo");	
			}
		}
		
		
	}
})
</script>
</body>
</html>
